Category,Number,Question,Answer,Hints,Example Answer,Data Source
Setup,1,Test Question to Set Up Your Instance. Type: ```| inputlookup server_power.csv | stats count as answer | sendanswer```,31272,Hints will go here!,| inputlookup server_power.csv | stats count as answer | sendanswer,| inputlookup server_power.csv from ML Toolkit
conf2016,1,"Dataset: ""| inputlookup server_power.csv"" - What is the average of the ""ac_power"" field?",239.802467,"Use stats! and don't forget to rename as ""answer"" and use | sendanswer to submit",stats avg(ac_power) as answer,| inputlookup server_power.csv from ML Toolkit
conf2016,2,"Dataset: ""| inputlookup server_power.csv"" - Use ""anomalydetection"" with ""action=annotate"" to find anomalies in the dataset.  Then return the probable_cause (one of the fields) with the highest number of anomalies.",total-disk-blocks,"Use ""anomalydetection"" with argument action.  Then combo of stats, sort, rename, etc.",| anomalydetection action=annotate | stats count by probable_cause | sort - count | head 1 | rename probable_cause as answer,| inputlookup server_power.csv from ML Toolkit
conf2016,3,"Dataset: ""| inputlookup server_power.csv"" - Compute the OVERALL average of ac_power.  Create a new field to determine the difference between each ac_power value and the overall average.  How many time does the difference exceed 80?",337,"Use ""eventstats"" for the average. Use eval to create new field to determine difference",| eventstats avg(ac_power) as overall_avg | eval diff=abs(ac_power-overall_avg) | search diff>80 | stats count as answer,| inputlookup server_power.csv from ML Toolkit
conf2016,4,"Dataset: ""milk.csv, iron.csv"" - In what year and month was the most total COMBINED production of milk and iron together?  The format of the answer should be yyyy-mm",1975-05,You'll need to join the datasets together on a common time format,"| inputlookup iron.csv | eval date=substr(date,1,7) | join type=outer date [| inputlookup milk.csv] | eval total_production=milk_production+iron_production | sort - total_production | rename date as answer | head 1","| inputlookup milk.csv, | inpoutlookup iron.csv from ML Toolkit"
conf2016,5,"Dataset: ""iron.csv"" - Using streamstats with a window of 20, how many events are outside 2 standard deviations for iron production?",32,"1. window is an argument of streamstats
2. You'll need to calculate an upper and lower bound
3. a bound = average +/- stdev*(# of deviations)","| inputlookup iron.csv | streamstats window=20 current=true avg(iron_production) as avg stdev(iron_production) as stdev | eval lBound=(avg-stdev*2), uBound=(avg+stdev*2) | eval isOutlier=if(iron_production < lBound OR iron_production > uBound, 1, 0) | where isOutlier=1 | stats count as answer",| inpoutlookup iron.csv from ML Toolkit
conf2016,6,"Dataset: ""batting.csv"" - For the years 2013 and 2014, how many players switched teams 3 times or more?",72,"Don't forget about the command ""| search"" or ""| where""",| inputlookup batting.csv | search yearID=2013 OR yearID=2014 | stats dc(teamID) as changes by playerID | search changes>2 | stats count as answer,| inputlookup batting.csv from ML Toolkit
conf2016,7,"Dataset: ""batting.csv"" - For the year 2014, how many players contributed to over 15% of their teams TOTAL RBIs?",13,How about some eventstats?,| inputlookup batting.csv | search yearID=2014 | eventstats sum(RBI) as Total_RBIs by teamID | stats sum(RBI) as RBIs by playerID teamID Total_RBIs | eval best_ratio=RBIs/Total_RBIs | search best_ratio>.15 | stats count as answer,| inputlookup batting.csv from ML Toolkit
conf2016,8,"Dataset: ""batting.csv"" - Use 'analyzefields' to determine the top 5 predictors/fields of RBIs sorted by the ""acc"" field in descending order .  Now take the average of both ""acc"" and ""balacc"".  What is the difference between these two results?  (Avg of ACC - Avg of BALACC)",0.294909,Not as hard as you think..,| inputlookup batting.csv | analyzefields classfield=RBI | sort - acc | head 5 | stats values(field) as answer,| inputlookup batting.csv from ML Toolkit
IoT_Cars,1,What was the highest coolant temperature (engineCoolantTemperature) out of all vehicles?,136,"Use stats! and don't forget to rename as ""answer""",stats max(engineCoolantTemperature) as answer,"https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0

Place car_data.csv into /TA_splbee/lookups/ directory"
IoT_Cars,2,What driver had the highest RPMs (engineSpeed)?,driver4,"You can use ""sort"" or ""head"" to get your answer to the stop",stats max(engineSpeed) as speed by driver | sort 1 - speed | rename driver as answer,https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
IoT_Cars,3,What vehicleId and year had the highest AVERAGE of acceleration/deceleration (longitudeGForce) G Forces? Your answer should have an underscore between it like: 21423_2012,50674_2008,The field longitudeGForce has positive and negative values for acceleration and decceleration. Make sure you use Absolute Value in your search!,"| eval longitudeGForce=abs(longitudeGForce) | eval vehicleId=vehicleId.""_"".year | stats avg(longitudeGForce) as gforce by vehicleId | rename vehicleId as answer | sort 1 - gforce",https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
IoT_Cars,4,"Create a table of values containing the fields ""speed"" ""engineSpeed"" and ""engineCoolantTemperature"" and run the new Anomaly Detection command on this subset. What vehicleId had the highest amount of anomalies?",50686,"Functions used: table, anomalydetection, rename",| table vehicleId speed engineSpeed engineCoolantTemperature | anomalydetection | rename vehicleId as answer,https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
IoT_Cars,5,What is the average MPG (instanateousMpg) of all vehicles newer than 2009? Round your answer to 2 decimal places (Ex. 25.86).,31.91,"Use eval to create a new field called model where models greater than 2009 are ""new"" else they are ""old""","| eval model=if(year>2009,""new"",""old"") | stats avg(instanateousMpg) as answer by model | search model=""new"" | eval answer = round(answer,2)",https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
IoT_Cars,6,How many vehicles individual STDEV of Coolant Temperature exceeded the overall STDEV of all vehicles?,2,You can use eventstats or subsearch.,| eventstats stdev(engineCoolantTemperature) as total_stdev | stats stdev(engineCoolantTemperature) as car_stdev by vehicleId total_stdev | stats count(eval(car_stdev>total_stdev)) as answer,https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
IoT_Cars,7,Which vehicleId had the greatest change in lateral G-force (lateralGForce) over a 5 event window?,50691,No more Hints!,| inputlookup car_data.csv | streamstats window=5 min(lateralGForce) as minlat max(lateralGForce) as maxlat by vehicleId | stats min(minlat) max(maxlat) by vehicleId | eval chg='max(maxlat)'-'min(minlat)' | sort - chg | head 1 | rename vehicleId as answer,https://www.dropbox.com/sh/jfxdeo3c5rni1nj/AAB0QGimvdKWtvgTPvO6FkaZa?dl=0
Stocks,1,What stock has the highest opening bid? Dataset: ``stocks.csv`` ,BCUP,Sort descending,|inputlookup stocks.csv|stats max(Open) as open by stock|sort - open|head 1|fields stock,https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,2,What stock had the highest daily difference in High and Low bids? Dataset: ``stocks.csv``,NAY,Compare High and Low,|inputlookup stocks.csv |eval diff=High-Low|sort - diff|head 1|fields stock,https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,3,What was the lowest daily difference in High and Low bids across all stocks? (round two decimal places) Dataset: ``stocks.csv`` ,0.23,Compare High and Low,|inputlookup stocks.csv |eval diff=High-Low|sort + diff|head 1|fields diff,https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,4,Which stock sold the highest volume over a 5 day period? Dataset: ``stocks.csv`` ,PWNY,streamstats is your friend!,|inputlookup stocks.csv|sort 0 + _time|streamstats time_window=5d sum(Volume) as total_volume by stock|sort 0 - total_volume|head 1|rename stock as answer,https://www.nasdaq.com/market-activity/quotes/historical
Stocks,5,What stock had no data in 2012? Dataset: ``stocks.csv`` ,NAY,Compare active stocks to the list of all stocks,"|inputlookup stocks.csv|where strftime(_time,%Y)=2012|stats count by stock|appendpipe [|inputlookup stocks.csv|stats count as _count by stock]|stats values(count) as count by stock|where isnull(count)|fields stock",https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,6,What date had the greatest change from previous day in opening bid for PWNY stock? (Use epoch format) Dataset: `stocks.csv` ,1413763200.000000,Use absolute values. Make sure you sort ascending by time,|inputlookup stocks.csv where stock=PWNY|sort 0 + _time|delta Open as diff|eval diff=abs(diff)|sort - diff|head 1|fields _time,https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,7,What is the minimum stock value for the average high bid over a 5 day rolling window? (Round 2 decimal places) Dataset: `stocks.csv` ,26.92,streamstats is key,"|inputlookup stocks.csv |sort 0 _time |streamstats avg(High) as avg_high by stock time_window=5d|stats min(avg_high) as min_rolling_avg|eval min_rolling_avg=round(min_rolling_avg,2)",https://www.nasdaq.com/market-activity/quotes/historical with changed stock names
Stocks,8,How many anomalies are found for Volume in BCUP stock data? Dataset: `stocks.csv` ,12,Use an anomalydetection command,"|inputlookup stocks.csv where stock=""BCUP""| anomalydetection Volume action=summary|rename num_anomalies as answer",https://www.nasdaq.com/market-activity/quotes/historical
Stocks,9,What date had the greatest BCUP stock price range achieved in one day? (Use epoch format) Dataset: `stocks.csv` ,1603238400.000000,Compare the max difference with each dates' differences,|inputlookup stocks.csv where stock=BCUP| eval diff=High-Low|eventstats max(diff) as max_diff|where diff=max_diff|fields _time|rename _time as answer,https://www.nasdaq.com/market-activity/quotes/historical
Stocks,10,"For BCUP stock, how many days had an open stock price greater than the latest 10-day average? Dataset: `stocks.csv` ",557,"Weekends are not included in the data, use window=10 instead of time_window=10d","| inputlookup stocks.csv where stock=BCUP | sort 0 + _time  | streamstats avg(Open) as avg_open count window=10  | eventstats max(_time) as max_time  | reverse  | eval avg_open=if(max_time=_time,avg_open,null())  | filldown avg_open  | where Open&gt;avg_open | stats count",https://www.nasdaq.com/market-activity/quotes/historical
Food and Beverages,1,Where is the most sugar consumed across the entire population? Dataset: `food_intake.csv`,Home,Sum values,"| inputlookup stocks.csv where stock=BCUP
| sort 0 + _time 
| streamstats avg(Open) as avg_open count window=10 
| eventstats max(_time) as max_time 
| reverse 
| eval avg_open=if(max_time=_time,avg_open,null()) 
| filldown avg_open 
| where Open>avg_open
| stats count",https://www.ers.usda.gov/data-products/food-consumption-and-nutrient-intakes/
Food and Beverages,2,What food group did children not receive in 2017-2018 at school? Dataset: `food_intake.csv`,VegetablesDarkGreen,Missing data or 0 values?,| inputlookup food_intake.csv where Demographic=Children* AND Location=School AND Period=2017-2018 AND Value=0|fields FoodGroup|rename FoodGroup as answer,https://www.ers.usda.gov/data-products/food-consumption-and-nutrient-intakes/
Food and Beverages,3,What is the most popular unit of measure across all food groups? Dataset: `food_intake.csv`,cup,Distinctly count the groups,| inputlookup food_intake.csv|stats dc(FoodGroup) as groups by Unit|sort - groups|head 1|rename Unit as answer,https://www.ers.usda.gov/data-products/food-consumption-and-nutrient-intakes/
Food and Beverages,4,Which demographic had the highest increase in fats between periods? Dataset: `food_intake.csv`,Household income 185–300% poverty line,Find the delta between 2015-2016 to 2017-2018,"| inputlookup food_intake.csv WHERE FoodGroup=""fats"" | sort 0 period | streamstats current=false last(Value) AS lastValue BY Demographic | eval changeValue=lastValue-Value | sort 0 -changeValue | head 1 | table Demographic",https://www.ers.usda.gov/data-products/food-consumption-and-nutrient-intakes/
Food and Beverages,5,Is Beer or Wine consumed more? Dataset: `alcohol.csv`,Beer,Sum the litres,| inputlookup alcohol.csv where Type=Beer OR Type=Wine|stats sum(Litres) as litres by Type|sort - litres|rename Type as answer|head 1,https://www.who.int/data/gho/data/indicators/indicator-details/GHO/alcohol-recorded-per-capita-(15-)-consumption-(in-litres-of-pure-alcohol)
Food and Beverages,6,What percentage of countries are in all groups when grouping litres into 10 clusters? (round percentage to 2 decimal places) Dataset: `alcohol.csv`,5.82,use kmeans and eventstats,"| inputlookup alcohol.csv|kmeans Litres k=10|stats dc(CLUSTERNUM) as cluster_count by Country|eventstats dc(Country) as total_countries|search cluster_count=10|stats dc(Country) as countries max(total_countries) as total|eval answer=round((countries/total)*100,2)",https://www.who.int/data/gho/data/indicators/indicator-details/GHO/alcohol-recorded-per-capita-(15-)-consumption-(in-litres-of-pure-alcohol)
Firewall,1,What is the median percentage of known vulnerabilities per source country? (round 2 decimal places) Dataset: `firewall_traffic.csv` ,88.92,Use iplocation,"|inputlookup firewall_traffic.csv| iplocation src_ip|stats count(eval(has_known_vulnerability=""yes"")) as yes count as total by Country|eval perc=(yes/total)*100|stats median(perc) as answer",|inputlookup firewall_traffic.csv from ML Toolkit
Firewall,2,What destination ip had the most missing packets? Dataset: `firewall_traffic.csv`,84.216.108.116,sent should be less than received,|inputlookup firewall_traffic.csv|where packets_sent<packets_received|stats count by dst_ip|sort - count |rename dst_ip as answer|head 1,|inputlookup firewall_traffic.csv from ML Toolkit
Firewall,3,What is the accuracy of predicting traffic used by malware based on bytes sent? (round 2 decimal places) Dataset: `firewall_traffic.csv`,0.76,use analyzefields,"|inputlookup firewall_traffic.csv| analyzefields classfield=used_by_malware|search field=""bytes_sent""|rename acc as answer",|inputlookup firewall_traffic.csv from ML Toolkit
ButtercupGames,6,How many distinct sessions removed an item before purchasing? Dataset: `index=tutorial`,434,Use transaction or streamstats,"index=tutorial sourcetype=access_combined_wcookie|transaction JSESSIONID startswith=""action=remove"" endswith=""action=purchase""|stats dc(JSESSIONID) as answer",index=tutorial sourcetype=access_combined_wcookie
ButtercupGames,1,What is the most viewed product? Dataset: `index=tutorial`,SC-MG-G10,action=view,index=tutorial sourcetype=access_combined_wcookie action=view|stats count by productId|sort - count|fields productId|rename productId as answer,index=tutorial sourcetype=access_combined_wcookie
ButtercupGames,2,Which IP address viewed the top product most? Dataset: `index=tutorial`,87.194.216.51,Remember that SC-MG-G10 was the top viewed product,index=tutorial sourcetype=access_combined_wcookie action=view productId=SC-MG-G10|stats count by clientip|sort - count|fields clientip|rename clientip as answer,index=tutorial sourcetype=access_combined_wcookie
ButtercupGames,3,Which vendor was the first to sell the top-selling product code? Dataset: `index=tutorial`,1065,Use the vendor_sales sourcetype and find the most common code and earliest vendor,index=tutorial sourcetype=vendor_sales|stats earliest(VendorID) as vendor count by Code|sort - count|fields vendor|head 1|rename vendor as answer,index=tutorial sourcetype=vendor_sales
ButtercupGames,4,When was the first event indexed in the tutorial data (YYYY/mm/dd HH:MM:SS)? Dataset: `index=tutorial`,2024/05/03 16:02:05,Use _indextime,"index=tutorial |stats min(_indextime) as answer|eval answer=strftime(answer,%Y/%m/%d %T)",index=tutorial
ButtercupGames,5,Which country has most login failures? Dataset: `index=tutorial`,United States,Use rex and iplocation,"index=tutorial sourcetype=secure-2 ""Failed password""|rex ""from\s(?<ip>[^\s]+)""|iplocation ip|stats count by Country|sort - count|head 1|rename Country as answer",index=tutorial sourcetype=secure-2 
Internal Logs,4,"How many parsing pipeline metrics logs were indexed between June 1, 2024 20:30:00 and June 1, 2024 21:30:00 Dataset: `index=mock_internal`",342,Use _index_earliest and _index_latest. Time format is %m/%d/%Y:%H:%M:%S,index=mock_internal _index_earliest=06/01/2024:20:30:00 _index_latest=06/01/2024:21:30:00 source=/opt/splunk/var/log/splunk/metrics.log name=parsing|stats count,"index=mock_internal source=""/opt/splunk/var/log/splunk/metrics.log"""
Internal Logs,3,What is the skip ratio for scheduled searches? Round 2 decimal places and format with % Dataset: `index=mock_internal`,5.51%,Use eventstats for the total searches,"index=mock_internal sourcetype=mock_scheduler |stats count by status|eventstats sum(count) as total|eval answer=round((count/total)*100,2).%|search status=skipped",index=mock_internal sourcetype=mock_scheduler
Internal Logs,1,What is the maximum CPU percentage for an IOWait event? Dataset: `index=mock_introspection`,38.00,"You might need to rename ""data.max_cpus_pct{}"" before using stats",index=mock_introspection component=IOWait|rename data.max_cpus_pct{} as answer|stats max(answer) as answer,index=mock_introspection 
Internal Logs,2,Which process was executed most often? Dataset: `index=mock_introspection`,dash,Distinctly count the process id for each process,"index=""mock_introspection"" component=PerProcess
| stats dc(data.pid) as count by data.process
| sort 0 -count
| head 1
| rename data.process as answer",index=mock_introspection 
Internal Logs,5,What is the full path for the mongod PEM file?  Dataset: `index=mock_introspection`,/opt/splunk/etc/auth/splunkweb/SplunkShow.pem,You can use rex or combine split and mvindex. The field this can be found in is data.args,"index=""mock_introspection"" component=PerProcess data.process=mongod
| stats count by data.args
| eval answer=mvindex(split(mvindex(split('data.args',""sslPEMKeyFile=""),1),"" ""),0)",index=mock_introspection 
